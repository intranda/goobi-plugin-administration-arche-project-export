<ui:composition
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:composite="http://xmlns.jcp.org/jsf/composite"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:intranda="http://xmlns.jcp.org/jsf/composite/composites"
    xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
    xmlns:p="http://primefaces.org/ui"
    xmlns:button="http://goobi.io/button"
    xmlns:section="http://goobi.io/section">
    <h:panelGroup>

        <!-- select project to export -->
        <intranda:box
            boxForm="true"
            boxPadding="false"
            boxType="primary"
            icon="fa fa-plug"
            id="selectionBox"
            title="#{msgs[AdministrationForm.administrationPlugin.title]}">

            <h:panelGroup rendered="#{!LoginForm.hasRole('Plugin_administration_arche_project_export')}">
                <h:outputText
                    styleClass="alert alert-danger"
                    value="#{msgs.plugin_administration_missingPermission} Plugin_administration_arche_project_export"></h:outputText>
            </h:panelGroup>

            <h:form
                rendered="#{LoginForm.hasRole('Plugin_administration_arche_project_export')}"
                id="actionForm"
                enctype="multipart/form-data">

                <intranda:formInputDropDownAjax
                    id="project"
                    label="#{msgs.projekt}"
                    field="#{AdministrationForm.administrationPlugin.projectId}"
                    help="#{msgs.helpProcessProject}"
                    name="prozess"
                    selectItems="#{AdministrationForm.administrationPlugin.possibleProjects}"
                    required="false"
                    var="var"
                    hidePleaseSelectMessage="false"
                    itemLabel="#{var.titel}"
                    itemValue="#{var.id}"
                    ajaxEvent="change"
                    ajaxRender="@all" />
            </h:form>
        </intranda:box>
        <br />
        <!-- display selected project and edit configured properties -->
        <intranda:box
            boxForm="true"
            boxPadding="false"
            boxType="action"
            icon="fa fa-plug"
            id="editBox"
            rendered="#{AdministrationForm.administrationPlugin.selectedProject != null}"
            title="#{msgs.projektBearbeiten}">


            <h:form
                rendered="#{LoginForm.hasRole('Plugin_administration_arche_project_export')}"
                id="editForm"
                enctype="multipart/form-data">

                <!-- project title data -->
                <intranda:formInputText
                    id="title"
                    name="titel"
                    label="#{msgs.projekt}"
                    field="#{AdministrationForm.administrationPlugin.selectedProject.titel}"
                    help="#{msgs.helpProcessTitle}"
                    required="false"
                    readonly="true" />


                <intranda:formInputText
                    id="projectIdentifier"
                    name="projectIdentifierName"
                    label="#{msgs.project_projectIdentifier}"
                    field="#{AdministrationForm.administrationPlugin.selectedProject.projectIdentifier}"
                    help="#{msgs.help_project_projectIdentifier}"
                    required="false"
                    readonly="true" />

                <intranda:formInputText
                    id="institution"
                    label="#{msgs.institution}"
                    field="#{AdministrationForm.administrationPlugin.selectedProject.institution.shortName}"
                    help="#{msgs.helpProjectInstitution}"
                    name="institutionName"
                    required="false"
                    readonly="true" />

                <!-- number of pages -->
                <intranda:formInputText
                    id="numberImages"
                    name="numberImagesName"
                    label="#{msgs.numberImages}"
                    field="#{AdministrationForm.administrationPlugin.selectedProject.numberOfPages}"
                    help="#{msgs.helpNumberImages}"
                    required="false"
                    readonly="true" />

                <!-- number of volumes -->
                <intranda:formInputText
                    id="numberVolumes"
                    name="numberVolumesName"
                    label="#{msgs.numberVolumes}"
                    field="#{AdministrationForm.administrationPlugin.selectedProject.numberOfVolumes}"
                    help="#{msgs.helpNumberVolumes}"
                    required="false"
                    readonly="true" />

                <div class="row">
                    <div
                        class="col-12 col-md-3"
                        tabindex="-1">
                        <intranda:formLabel
                            label="#{msgs.startdate}"
                            labelFor="startDate" />
                    </div>
                    <div class="col-12 col-md-9">
                        <h:inputText
                            id="startDate"
                            styleClass="form-control form__input"
                            value="#{AdministrationForm.administrationPlugin.selectedProject.startDate}"
                            required="false"
                            readonly="true"
                            disabled="true">
                            <f:convertDateTime pattern="yyyy-MM-dd" />
                        </h:inputText>
                    </div>
                </div>


                <div class="row">
                    <div
                        class="col-12 col-md-3"
                        tabindex="-1">
                        <intranda:formLabel
                            label="#{msgs.enddate}"
                            labelFor="endDate" />
                    </div>
                    <div class="col-12 col-md-9">
                        <h:inputText
                            id="endDate"
                            styleClass="form-control form__input"
                            value="#{AdministrationForm.administrationPlugin.selectedProject.endDate}"
                            required="false"
                            readonly="true"
                            disabled="true">
                            <f:convertDateTime pattern="yyyy-MM-dd" />
                        </h:inputText>
                    </div>
                </div>


                <!--  display configured properties -->
                <ui:repeat
                    var="property"
                    value="#{AdministrationForm.administrationPlugin.displayProperties}">
                    
                    <ui:fragment rendered="#{property.type.name == 'text'}">
                     <div class="row">
                        <div class="col-12 col-md-3">
                            <intranda:formLabel
                                label="#{property.name}"
                                labelFor="value"/>
                        </div>
                        <div class="col-12 col-md-9">
                            <h:inputText
                                id="value"
                                styleClass="form-control"
                                value="#{property.value}"
                                readonly="false"
                                binding="#{value}">
                            </h:inputText>
                            <intranda:formHelp msgFor="#{value.clientId}" content="#{msgs.helpPropertyValue}" />
                        </div>
                    </div>
                    
                    </ui:fragment>
                    <ui:fragment rendered="#{property.type.name == 'textarea'}">
                     <div class="row">
                        <div class="col-12 col-md-3">
                            <intranda:formLabel
                                label="#{property.name}"
                                labelFor="textareaValue"
                                labelRequired="#{property.showProcessGroupAccessCondition == 'WRITEREQUIRED'}"/>
                        </div>
                        <div class="col-12 col-md-9">
                            <h:inputTextarea
                                id="textareaValue"
                                rows="7"
                                styleClass="form-control"
                                value="#{property.value}"
                                readonly="#{property.showProcessGroupAccessCondition == 'READ'}">
                            </h:inputTextarea>
                            <h:message
                                for="textareaValue"
                                showDetail="true"
                                styleClass="help-inline font-danger" />
                            <intranda:formHelp content="#{msgs.helpPropertyValue}" />
                        </div>
                    </div>
                    
                    </ui:fragment>

                    <ui:fragment rendered="#{property.type.name == 'list'}">
                     <div class="row">
                        <div class="col-12 col-md-3">
                            <intranda:formLabel
                                label="#{property.name}"
                                labelFor="select"
                                labelRequired="#{property.showProcessGroupAccessCondition == 'WRITEREQUIRED'}"/>
                        </div>
                        <div class="col-12 col-md-9">
                            <h:selectOneMenu
                                id="select"
                                styleClass="form-control form-select"
                                disabled="#{property.showProcessGroupAccessCondition == 'READ'}"
                                value="#{property.value}"
                                binding="#{select}">
                                <f:selectItems
                                    value="#{property.possibleValues}"
                                    var="propertys"
                                    itemLabel="#{propertys}"
                                    itemValue="#{propertys}" />
                            </h:selectOneMenu>
                            <intranda:formHelp msgFor="#{select.clientId}" content="#{msgs.helpPropertyValue}" />
                        </div>
                    </div>
                    
                    </ui:fragment>

                    <ui:fragment rendered="#{property.type.name == 'boolean'}">
                    <div class="row">
                        <div class="col-12 col-md-3">
                            <intranda:formLabel
                                label="#{property.name}"
                                labelFor="boolean"
                                labelRequired="#{property.showProcessGroupAccessCondition == 'WRITEREQUIRED'}"/>
                        </div>
                        <div class="col-12 col-md-9">
                            <h:selectBooleanCheckbox
                                id="boolean"
                                value="#{property.booleanValue}"
                                disabled="#{property.showProcessGroupAccessCondition == 'READ'}">
                            </h:selectBooleanCheckbox>
                            <h:message
                                for="boolean"
                                showDetail="true"
                                styleClass="help-inline font-danger" />
                            <intranda:formHelp content="#{msgs.helpPropertyValue}" />
                        </div>
                    </div>
                    
                    </ui:fragment>

                    <ui:fragment rendered="#{property.type.name == 'date'}">
                     <div class="row">
                        <div class="col-12 col-md-3">
                            <intranda:formLabel
                                label="#{property.name}"
                                labelFor="date"
                                labelRequired="#{property.showProcessGroupAccessCondition == 'WRITEREQUIRED'}"/>
                        </div>
                        <div class="col-12 col-md-9">
                            <p:calendar
                                id="date"
                                value="#{property.dateValue}"
                                locale="#{SpracheForm.locale}"
                                styleClass="ff-goobi"
                                mask="true"
                                navigator="true"
                                yearRange="-100:+100"
                                pattern="#{property.pattern}">
                                <f:passThroughAttribute name="autocomplete" value="off" />
                            </p:calendar>
                            <h:message
                                for="date"
                                showDetail="true"
                                styleClass="help-inline font-danger" />
                            <intranda:formHelp content="#{msgs.helpPropertyValue}" />
                        </div>
                    </div>
                    
                    </ui:fragment>

                 
                    
                    

                </ui:repeat>


            </h:form>
        </intranda:box>

    </h:panelGroup>
</ui:composition>